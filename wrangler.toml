name = "grepbase"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]
pages_build_output_dir = "apps/web/out"

# Analytics Engine binding for monitoring
[[analytics_engine_datasets]]
binding = "ANALYTICS"

# Observability
[observability]
enabled = true

# D1 Database binding
[[d1_databases]]
binding = "grepbase_db"
database_name = "grepbase-db"
database_id = "326233af-b937-4c0b-ab47-7349f251b961"
migrations_dir = "apps/api/drizzle"

# KV Namespace binding
[[kv_namespaces]]
binding = "grepbase_cache"
id = "6fbff750f7314c7ca6435e68966769bb"

# R2 bucket binding for large file storage
# Note: Create buckets with: wrangler r2 bucket create <bucket-name>
[[r2_buckets]]
binding = "grepbase_storage"
bucket_name = "grepbase-files"

# Environment-specific configuration
[env.production]
vars = { ENVIRONMENT = "production" }

[[env.production.d1_databases]]
binding = "grepbase_db"
database_name = "grepbase-db"
database_id = "326233af-b937-4c0b-ab47-7349f251b961"
migrations_dir = "apps/api/drizzle"

[[env.production.kv_namespaces]]
binding = "grepbase_cache"
id = "6fbff750f7314c7ca6435e68966769bb"

[[env.production.analytics_engine_datasets]]
binding = "ANALYTICS"

[[env.production.r2_buckets]]
binding = "grepbase_storage"
bucket_name = "grepbase-files-prod"

[env.preview]
vars = { ENVIRONMENT = "preview" }

[[env.preview.d1_databases]]
binding = "grepbase_db"
database_name = "grepbase-db"
database_id = "326233af-b937-4c0b-ab47-7349f251b961"
migrations_dir = "apps/api/drizzle"

[[env.preview.kv_namespaces]]
binding = "grepbase_cache"
id = "6fbff750f7314c7ca6435e68966769bb"

[[env.preview.analytics_engine_datasets]]
binding = "ANALYTICS"

[[env.preview.r2_buckets]]
binding = "grepbase_storage"
bucket_name = "grepbase-files-preview"
